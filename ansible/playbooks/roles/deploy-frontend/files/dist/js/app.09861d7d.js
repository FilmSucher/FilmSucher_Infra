(function(){"use strict";var e={9954:function(e,t,r){var a=r(5130),o=r(6768);const n={id:"app"};function i(e,t,r,a,i,s){const l=(0,o.g2)("Header"),u=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.bF)(l),(0,o.bF)(u)])}var s=r(4232);const l={class:"header"},u={class:"auth-buttons"},d={class:"username"};function c(e,t,r,a,n,i){const c=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("header",l,[(0,o.bF)(c,{to:"/",class:"title-link"},{default:(0,o.k6)(()=>t[2]||(t[2]=[(0,o.Lk)("div",{class:"title"},"Film Sucher",-1)])),_:1,__:[2]}),(0,o.Lk)("div",u,[a.isAuthenticated?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("span",d,(0,s.v_)(a.username),1),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.favorites&&a.favorites(...e))},"MyList"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.handleLogout&&a.handleLogout(...e))},"Logout")],64)):((0,o.uX)(),(0,o.Wv)(c,{key:1,to:"/login"},{default:(0,o.k6)(()=>t[3]||(t[3]=[(0,o.Lk)("button",null,"Login",-1)])),_:1,__:[3]})),a.isAdmin?((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.bF)(c,{to:"/add-movie"},{default:(0,o.k6)(()=>t[4]||(t[4]=[(0,o.Lk)("button",null,"Add New Film",-1)])),_:1,__:[4]}),(0,o.bF)(c,{to:"/edit-users"},{default:(0,o.k6)(()=>t[5]||(t[5]=[(0,o.Lk)("button",null,"Manage Users",-1)])),_:1,__:[5]})],64)):(0,o.Q3)("",!0)])])}r(4114);var m=r(1387),p=(r(4979),r(144));const v=(0,p.KR)(!!localStorage.getItem("token"));function f(e,t){localStorage.setItem("token",e),localStorage.setItem("username",t),v.value=!0}function h(){localStorage.removeItem("token"),localStorage.removeItem("username"),v.value=!1}function g(){return{isAuthenticated:v}}function y(){const e=localStorage.getItem("token");if(!e)return null;try{const t=e.split(".")[1],r=JSON.parse(atob(t)),a=r.exp;return Date.now()>=1e3*a?null:r.role||null}catch(t){return null}}var k={setup(){const e=(0,m.rd)(),{isAuthenticated:t}=g(),r=(0,o.EW)(()=>localStorage.getItem("username")),a=(0,o.EW)(()=>"ADMIN"===y()),n=()=>{h(),e.push("/")},i=()=>{e.push("/favorites")};return{isAuthenticated:t,username:r,isAdmin:a,handleLogout:n,favorites:i}}},L=r(1241);const E=(0,L.A)(k,[["render",c],["__scopeId","data-v-962957d6"]]);var b=E,w={components:{Header:b}};const A=(0,L.A)(w,[["render",i]]);var C=A;const I={class:"home"},_={class:"search-box"};function F(e,t,r,n,i,s){return(0,o.uX)(),(0,o.CE)("div",I,[(0,o.Lk)("div",_,[t[3]||(t[3]=(0,o.Lk)("h1",null,"Film Sucht",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.query=e),onKeyup:t[1]||(t[1]=(0,a.jR)((...e)=>n.search&&n.search(...e),["enter"])),placeholder:"Text fÃ¼r suche"},null,544),[[a.Jo,n.query]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.search&&n.search(...e))},"Such")])])}var U={setup(){const e=(0,p.KR)(""),t=(0,m.rd)(),r=(0,m.lq)(),a=()=>{const r=e.value.trim();0!==r.length&&t.push({name:"Results",query:{prompt:r}})};return(0,o.sV)(()=>{const t=r.query.prompt;t&&(e.value=t,a())}),{query:e,search:a}}};const S=(0,L.A)(U,[["render",F],["__scopeId","data-v-5439be24"]]);var q=S;const R={class:"auth"},T={class:"form-group"},M={class:"form-group"},N={class:"buttons"},j={key:0,class:"message"};function $(e,t,r,n,i,l){return(0,o.uX)(),(0,o.CE)("div",R,[t[4]||(t[4]=(0,o.Lk)("h1",null,"Login or Registration",-1)),(0,o.Lk)("div",T,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.username=e),placeholder:"Username",autocomplete:"username"},null,512),[[a.Jo,n.username]])]),(0,o.Lk)("div",M,[(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),placeholder:"Password",autocomplete:"current-password"},null,512),[[a.Jo,n.password]])]),(0,o.Lk)("div",N,[(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.handleLogin&&n.handleLogin(...e))},"Login"),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.register&&n.register(...e))},"Registration")]),n.message?((0,o.uX)(),(0,o.CE)("div",j,(0,s.v_)(n.message),1)):(0,o.Q3)("",!0)])}var D={setup(){const e=(0,p.KR)(""),t=(0,p.KR)(""),r=(0,p.KR)(""),a=(0,m.rd)(),o=async()=>{const o=e.value.trim(),n=t.value.trim();if(0!==o.length&&0!==n.length)try{const o=await fetch("/api/users/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e.value,password:t.value})});let n={};try{n=await o.json()}catch(i){console.warn("Invalid JSON in response")}o.ok&&n.token?(f(n.token,e.value),a.push("/")):r.value=n.message||`Login failed with status ${o.status}`}catch(s){r.value="Auth-Server is not available"}else console.error("Username or Password is empty")},n=async()=>{const a=e.value.trim(),o=t.value.trim();if(0!==a.length&&0!==o)try{const a=await fetch("/api/users/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e.value,password:t.value})});a.ok?r.value="Registration was successful. Now log in to your profile.":r.value=data.message||`Registration failed with status ${a.status}`}catch(n){r.value="Auth-Server is not available"}else console.error("Username or Password is empty")};return{username:e,password:t,handleLogin:o,register:n,message:r}}};const K=(0,L.A)(D,[["render",$],["__scopeId","data-v-6cfe337a"]]);var O=K;const X={class:"result"},J={class:"search-box"},V={key:0},P={key:1},B={class:"cards"};function x(e,t,r,n,i,s){const l=(0,o.g2)("MovieCard");return(0,o.uX)(),(0,o.CE)("div",X,[(0,o.Lk)("div",J,[t[3]||(t[3]=(0,o.Lk)("h1",null,"Film Sucht",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.query=e),onKeyup:t[1]||(t[1]=(0,a.jR)((...e)=>n.search&&n.search(...e),["enter"])),placeholder:"query"},null,544),[[a.Jo,n.query]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.search&&n.search(...e))},"Such")]),n.loading?((0,o.uX)(),(0,o.CE)("div",V,"Loading...")):0===n.films.length?((0,o.uX)(),(0,o.CE)("div",P,"Kein Results")):(0,o.Q3)("",!0),(0,o.Lk)("div",B,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.films,e=>((0,o.uX)(),(0,o.Wv)(l,{key:e.id,filmId:e.id,title:e.title,year:e.year,genre:e.genre,description:e.description,rating:e.rating,bildUrl:e.bildUrl,duration:e.duration,country:e.country,"is-admin":n.isAdmin,onDeleted:n.refresh},null,8,["filmId","title","year","genre","description","rating","bildUrl","duration","country","is-admin","onDeleted"]))),128))])])}const W={class:"card"},z={class:"column poster"},Q=["src","alt"],G={class:"column info"},H={class:"title"},Y={class:"year"},Z={class:"genre"},ee={class:"duration"},te={class:"country"},re={class:"description"},ae={class:"actions"},oe={class:"column rating"},ne={class:"rating-value"};function ie(e,t,r,a,n,i){return(0,o.uX)(),(0,o.CE)("div",W,[(0,o.Lk)("div",z,[(0,o.Lk)("img",{src:r.bildUrl,alt:r.title},null,8,Q)]),(0,o.Lk)("div",G,[(0,o.Lk)("h2",H,(0,s.v_)(r.title),1),(0,o.Lk)("p",Y,[t[4]||(t[4]=(0,o.Lk)("strong",null,"Year:",-1)),(0,o.eW)((0,s.v_)(r.year),1)]),(0,o.Lk)("p",Z,[t[5]||(t[5]=(0,o.Lk)("strong",null,"Genre:",-1)),(0,o.eW)(" "+(0,s.v_)(r.genre),1)]),(0,o.Lk)("p",ee,[t[6]||(t[6]=(0,o.Lk)("strong",null,"Duration:",-1)),(0,o.eW)((0,s.v_)(r.duration),1)]),(0,o.Lk)("p",te,[t[7]||(t[7]=(0,o.Lk)("strong",null,"Country:",-1)),(0,o.eW)((0,s.v_)(r.country),1)]),(0,o.Lk)("p",re,(0,s.v_)(r.description),1),(0,o.Lk)("div",ae,[(0,o.Lk)("template",null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.addFavorite&&i.addFavorite(...e))},"Add in MyList"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.delFavorite&&i.delFavorite(...e))},"Delete from MyList")]),r.isAdmin?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.editMovie&&i.editMovie(...e))},"Edit Film"),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>i.deleteMovie&&i.deleteMovie(...e))},"Delete Film")],64)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",oe,[(0,o.Lk)("p",ne,(0,s.v_)(r.rating),1)])])}var se={props:{filmId:{type:Number,required:!0},bildUrl:{type:String,required:!0},title:{type:String,required:!0},year:{type:String,required:!0},genre:{type:String,required:!1},description:{type:String,required:!1},rating:{type:[Number,String],required:!1},duration:{type:Number,required:!1},country:{type:String,required:!1},isAdmin:{type:Boolean,default:!1}},methods:{async addFavorite(){const e=localStorage.getItem("token");try{const t=await fetch(`/api/favors/${this.filmId}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});t.ok?alert("Film added in MyList!"):alert("Error! Film not added!")}catch(t){console.error("Error:",t)}},async delFavorite(){const e=localStorage.getItem("token");try{const t=await fetch(`/api/favors/${this.filmId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});t.ok?alert("Film deleted from MyList!"):alert("Error! Film not deleted!")}catch(t){console.error("Error:",t)}},async editMovie(){rt.push({name:"Edit",params:{id:this.filmId}})},async deleteMovie(){const e=window.confirm("Are you sure you want to delete this movie?");if(!e)return;const t=localStorage.getItem("token");try{const e=await fetch(`/api/films/${this.filmId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});e.ok?(alert("Film deleted"),this.$emit("deleted")):alert("Error! Film not deleted!")}catch(r){console.error("Error:",r)}}}};const le=(0,L.A)(se,[["render",ie],["__scopeId","data-v-105b9ae0"]]);var ue=le,de={components:{MovieCard:ue},setup(){const e=(0,m.rd)(),t=(0,m.lq)(),r=(0,p.KR)(t.query.prompt||""),a=(0,p.KR)([]),n=(0,p.KR)(!1),i=(0,p.KR)("ADMIN"===y()),s=async e=>{if(e){n.value=!0;try{const r=await fetch(`/api/films/films?prompt=${encodeURIComponent(e)}`);let o={};try{o=await r.json()}catch(t){alert("Invalid JSON in response")}r.ok&&Array.isArray(o)?a.value=o:(a.value=[],alert(o.message||`Search failed with status ${r.status}`))}catch(r){a.value=[],alert("Request Error: "+r.message)}finally{n.value=!1}}},l=()=>{const t=r.value.trim();0!==t.length&&e.push({name:"Results",query:{prompt:t}})},u=()=>{s(r.value)};return(0,o.sV)(()=>{r.value&&s(r.value)}),(0,o.wB)(()=>t.query.prompt,e=>{r.value=e||"",e&&s(e)}),{query:r,search:l,films:a,loading:n,isAdmin:i,refresh:u}}};const ce=(0,L.A)(de,[["render",x],["__scopeId","data-v-48fef090"]]);var me=ce;const pe={class:"favors"},ve={key:0},fe={key:1},he={class:"cards"};function ge(e,t,r,a,n,i){const s=(0,o.g2)("MovieCard");return(0,o.uX)(),(0,o.CE)("div",pe,[t[0]||(t[0]=(0,o.Lk)("h1",null,"MyList",-1)),a.loading?((0,o.uX)(),(0,o.CE)("div",ve,"Loading...")):0===a.films.length?((0,o.uX)(),(0,o.CE)("div",fe,"Kein Results")):(0,o.Q3)("",!0),(0,o.Lk)("div",he,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.films,e=>((0,o.uX)(),(0,o.Wv)(s,{key:e.id,filmId:e.id,title:e.title,year:e.year,genre:e.genre,description:e.description,rating:e.rating,bildUrl:e.bildUrl,duration:e.duration,country:e.country,"is-admin":a.isAdmin,onDeleted:a.refresh},null,8,["filmId","title","year","genre","description","rating","bildUrl","duration","country","is-admin","onDeleted"]))),128))])])}var ye={components:{MovieCard:ue},setup(){const e=(0,m.rd)(),t=(0,p.KR)([]),r=(0,p.KR)(!1),a=localStorage.getItem("token"),n=(0,p.KR)("ADMIN"===y()),i=async()=>{if(a){r.value=!0;try{const e=await fetch("/api/films/favorites",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}),r=await e.json();e.ok&&Array.isArray(r)?t.value=r:(t.value=[],alert(r.message||"Error! Favorites not fetched!"))}catch(o){alert("Request Error: "+o.message),t.value=[]}finally{r.value=!1}}else e.push("/login")},s=()=>{i()};return(0,o.sV)(i),{films:t,loading:r,isAdmin:n,refresh:s}}};const ke=(0,L.A)(ye,[["render",ge],["__scopeId","data-v-9c01dfea"]]);var Le=ke;const Ee={class:"form"},be={key:0},we=["src"],Ae={key:1,class:"message"};function Ce(e,t,r,n,i,l){return(0,o.uX)(),(0,o.CE)("div",Ee,[(0,o.Lk)("h2",null,(0,s.v_)(n.isEdit?"Edit Film":"Add New Film"),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.form.title=e),placeholder:"Titel"},null,512),[[a.Jo,n.form.title]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.form.year=e),placeholder:"Year"},null,512),[[a.Jo,n.form.year]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.form.genre=e),placeholder:"Ganre"},null,512),[[a.Jo,n.form.genre]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.form.duration=e),placeholder:"Duration"},null,512),[[a.Jo,n.form.duration]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.form.country=e),placeholder:"Country"},null,512),[[a.Jo,n.form.country]]),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.form.description=e),placeholder:"Description"},null,512),[[a.Jo,n.form.description]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.form.rating=e),placeholder:"Rating"},null,512),[[a.Jo,n.form.rating]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>n.form.image=e),placeholder:"Image URL"},null,512),[[a.Jo,n.form.image]]),(0,o.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>n.loadImage&&n.loadImage(...e))},"Load Image"),n.imagePreview?((0,o.uX)(),(0,o.CE)("div",be,[t[11]||(t[11]=(0,o.Lk)("p",null,"Bild preview:",-1)),(0,o.Lk)("img",{src:n.imagePreview,alt:"Preview",style:{"max-width":"100%","max-height":"300px"}},null,8,we)])):(0,o.Q3)("",!0),n.imageError?((0,o.uX)(),(0,o.CE)("div",Ae,(0,s.v_)(n.imageError),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>n.submit&&n.submit(...e))},"Save"),n.isEdit?((0,o.uX)(),(0,o.CE)("button",{key:2,onClick:t[10]||(t[10]=(...e)=>n.deleteMovie&&n.deleteMovie(...e))},"Delete")):(0,o.Q3)("",!0)])}var Ie={setup(){const e=localStorage.getItem("token"),t=(0,m.lq)(),r=(0,m.rd)(),a=(0,p.KR)(void 0!==t.params.id),n=(0,p.KR)({title:"",year:"",genre:"",duration:"",country:"",description:"",rating:"",image:""}),i=(0,p.KR)(""),s=(0,p.KR)("");(0,o.sV)(async()=>{if(a.value)try{const r=await fetch(`/api/films/films/${t.params.id}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),a=await r.json();r.ok?Object.assign(n.value,a):alert(a.message||"Error! Film not found!")}catch(r){alert("Error loading film: "+r.message)}});const l=async()=>{const o=window.confirm("Are you sure?");if(!o)return;if(!n.value.title.trim())return void alert("Title is required");if(isNaN(Number(n.value.year))||Number(n.value.year)<1888)return void alert("Enter a valid year");if(!n.value.genre.trim())return void alert("Genre is required");if(isNaN(Number(n.value.duration))||Number(n.value.duration)<0)return void alert("Enter a valid duration");if(!n.value.country.trim())return void alert("Country is required");if(!n.value.description.trim())return void alert("Description is required");if(isNaN(Number(n.value.rating))||Number(n.value.rating)<0||Number(n.value.rating)>10)return void alert("Enter a valid rating");const i=a.value?"PUT":"POST",s=a.value?`/api/films/admin_films/${t.params.id}`:"/api/films/admin_films",l={...n.value,year:Number(n.value.year),duration:Number(n.value.duration),rating:Number(n.value.rating)};try{const t=await fetch(s,{method:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(l)}),a=await t.json();t.ok?(alert(a.message||"Film saved!"),r.push("/")):alert(a.message||"Error! Film not saved!")}catch(u){alert("Error saved film: "+u.message)}},u=async()=>{const e=window.confirm("Are you sure you want to delete this movie?");if(!e)return;const t=localStorage.getItem("token");try{const e=await fetch(`/api/films/${this.filmId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});e.ok?(alert("Film deleted"),this.$emit("deleted")):alert("Error! Film not deleted!")}catch(r){console.error("Error:",r)}},d=async()=>{const e=n.value.image.trim();if(i.value="",s.value="",e.startsWith("http"))try{const t=await fetch(e,{method:"HEAD"}),r=t.headers.get("Content-Type")||"";if(!t.ok||!r.startsWith("image/"))return void(s.value="URL is not found!");i.value=e}catch(t){s.value="Image loading Error: "+t.message}else s.value="Wrong URL. Usually start with http/https"};return{form:n,loadImage:d,imagePreview:i,imageError:s,isEdit:a,submit:l,deleteMovie:u}}};const _e=(0,L.A)(Ie,[["render",Ce],["__scopeId","data-v-2af6c214"]]);var Fe=_e;const Ue={class:"film"},Se={class:"column poster"},qe=["src","alt"],Re={class:"column info"},Te={class:"title"},Me={class:"year"},Ne={class:"genre"},je={class:"duration"},$e={class:"country"},De={class:"rating"},Ke={class:"desc"},Oe={class:"description"},Xe={class:"actions"};function Je(e,t,r,a,n,i){return(0,o.uX)(),(0,o.CE)("div",Ue,[(0,o.Lk)("div",Se,[(0,o.Lk)("img",{src:a.form.posterUrl,alt:a.form.title},null,8,qe)]),(0,o.Lk)("div",Re,[(0,o.Lk)("h2",Te,(0,s.v_)(a.form.title),1),(0,o.Lk)("p",Me,[t[4]||(t[4]=(0,o.Lk)("strong",null,"Year:",-1)),(0,o.eW)((0,s.v_)(a.form.year),1)]),(0,o.Lk)("p",Ne,[t[5]||(t[5]=(0,o.Lk)("strong",null,"Genre:",-1)),(0,o.eW)(" "+(0,s.v_)(a.form.genre),1)]),(0,o.Lk)("p",je,[t[6]||(t[6]=(0,o.Lk)("strong",null,"Duration:",-1)),(0,o.eW)((0,s.v_)(a.form.duration),1)]),(0,o.Lk)("p",$e,[t[7]||(t[7]=(0,o.Lk)("strong",null,"Country:",-1)),(0,o.eW)((0,s.v_)(a.form.country),1)]),(0,o.Lk)("p",De,(0,s.v_)(a.form.rating),1)]),(0,o.Lk)("div",Ke,[(0,o.Lk)("p",Oe,(0,s.v_)(a.form.description),1)]),(0,o.Lk)("div",Xe,[(0,o.Lk)("template",null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.addFavorite&&a.addFavorite(...e))},"Add in MyList"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.delFavorite&&a.delFavorite(...e))},"Delete from MyList")]),a.isAdmin?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.editMovie&&a.editMovie(...e))},"Edit Film"),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>a.deleteMovie&&a.deleteMovie(...e))},"Delete Film")],64)):(0,o.Q3)("",!0)])])}var Ve={setup(){const e=localStorage.getItem("token"),t=(0,m.lq)(),r=(0,m.rd)(),a=(0,p.KR)("ADMIN"===y()),n=(0,p.KR)({filmId:"",title:"",year:"",genre:"",duration:"",country:"",rating:"",description:"",posterUrl:""});(0,o.sV)(async()=>{try{const r=await fetch(`/api/films/films/${t.params.id}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),a=await r.json();r.ok?Object.assign(n.value,a):alert(a.message||`Error fetching film: ${r.status}`)}catch(r){alert("Error loading user: "+r.message)}});const i=async()=>{r.push({name:"Edit",params:{id:n.value.filmId}})},s=async()=>{const t=window.confirm("Are you sure you want to delete this movie?");if(t){try{const t=await fetch(`/api/films/admin_films/${n.value.filmId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),r=await t.json();t.ok?alert(r.message||"Film deleted"):alert(r.message||"Error! Film not deleted!")}catch(a){alert("Error deleting film: "+a.message)}r.push("/")}},l=async()=>{try{const t=await fetch(`/api/films/favorites/${n.value.filmId}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),r=await t.json();t.ok?alert(r.message||"Film added in MyList!"):alert(r.message||"Error! Film not added!")}catch(t){alert("Error adding favorite: "+t)}},u=async()=>{try{const t=await fetch(`/api/favors/${this.filmId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});t.ok?alert("Film deleted from MyList!"):alert("Error! Film not deleted!")}catch(t){console.error("Error:",t)}};return{form:n,isAdmin:a,editMovie:i,deleteMovie:s,addFavorite:l,delFavorite:u}}};const Pe=(0,L.A)(Ve,[["render",Je],["__scopeId","data-v-fb65f94e"]]);var Be=Pe;const xe={class:"form"},We={class:"form-group"},ze={class:"form-group"},Qe={class:"role-selector"};function Ge(e,t,r,n,i,l){return(0,o.uX)(),(0,o.CE)("div",xe,[(0,o.Lk)("h2",null,(0,s.v_)(n.isEdit?"Edit User: "+e.id:"Add New User"),1),(0,o.Lk)("div",We,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.form.username=e),placeholder:"Username",autocomplete:"username"},null,512),[[a.Jo,n.form.username]])]),(0,o.Lk)("div",ze,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>n.form.password=e),placeholder:"Password",autocomplete:"password"},null,512),[[a.Jo,n.form.password]])]),(0,o.Lk)("div",Qe,[(0,o.Lk)("button",{class:(0,s.C4)({active:"USER"===n.form.role}),onClick:t[2]||(t[2]=e=>n.form.role="USER")},"User",2),t[6]||(t[6]=(0,o.Lk)("div",{class:"divider"},null,-1)),(0,o.Lk)("button",{class:(0,s.C4)({active:"ADMIN"===n.form.role}),onClick:t[3]||(t[3]=e=>n.form.role="ADMIN")},"Admin",2)]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.submit&&n.submit(...e))},"Save"),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.deleteUser&&n.deleteUser(...e))},"Delete")])}var He={setup(){const e=localStorage.getItem("token"),t=(0,m.lq)(),r=(0,m.rd)(),a=(0,p.KR)(void 0!==t.params.id),n=(0,p.KR)({username:"",password:"",role:"USER"});(0,o.sV)(async()=>{if(a.value)try{const r=await fetch(`/api/users/${t.params.id}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),a=await r.json();r.ok?Object.assign(n.value,a):alert(a.message||"Error! User not found!")}catch(r){alert("Error loading user: "+r.message)}});const i=async()=>{const e=window.confirm("Are you sure you want to delete this User?");if(!e)return;const t=localStorage.getItem("token");try{const e=await fetch(`/api/users/${this.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});e.ok?(alert("User deleted"),this.$emit("deleted")):alert("Error! User not deleted!")}catch(r){console.error("Error:",r)}},s=async()=>{if(!n.value.username.trim())return void alert("Username is required");if(n.value.password.trim()&&n.value.password.trim().length<8)return void alert("Password must be at least 8 characters long");if(!["USER","ADMIN"].includes(n.value.role))return void alert("Role is invalid");const o=a.value?"PATCH":"POST",i=a.value?`/api/users/admin/user/${t.params.id}`:"/api/users/admin/user";try{const t=await fetch(i,{method:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(n.value)}),a=await t.json();t.ok?(alert(a.message||"User saved!"),r.push("/users")):alert(a.message||"Error! User not saved!")}catch(s){alert("Error user saved: "+s.message)}};return{form:n,isEdit:a,submit:s,deleteUser:i}}};const Ye=(0,L.A)(He,[["render",Ge],["__scopeId","data-v-29a09afc"]]);var Ze=Ye;const et=[{path:"/",name:"Home",component:q},{path:"/login",name:"Login",component:O},{path:"/results",name:"Results",component:me},{path:"/film/:id",name:"Film",component:Be},{path:"/favorites",name:"Favorites",component:Le,meta:{requiresAuth:!0}},{path:"/edit/:id",name:"Edit",component:Fe,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/add",name:"Add",component:Fe,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/users/edit/:id",name:"Edit User",component:Ze,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/users/add",name:"Add User",component:Ze,meta:{requiresAuth:!0,requiresAdmin:!0}}],tt=(0,m.aE)({history:(0,m.LA)(),routes:et});tt.beforeEach((e,t,r)=>{const a=localStorage.getItem("token"),o=y();e.meta.requiresAuth&&!a?r({name:"Login"}):e.meta.requiresAdmin&&"ADMIN"!==o?r({name:"Home"}):r()});var rt=tt;(0,a.Ef)(C).use(rt).mount("#app")}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,function(){var e=[];r.O=function(t,a,o,n){if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],n=e[d][2];for(var s=!0,l=0;l<a.length;l++)(!1&n||i>=n)&&Object.keys(r.O).every(function(e){return r.O[e](a[l])})?a.splice(l--,1):(s=!1,n<i&&(i=n));if(s){e.splice(d--,1);var u=o();void 0!==u&&(t=u)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,o,n]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,i=a[0],s=a[1],l=a[2],u=0;if(i.some(function(t){return 0!==e[t]})){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(l)var d=l(r)}for(t&&t(a);u<i.length;u++)n=i[u],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},a=self["webpackChunkfilm_sucher_vue"]=self["webpackChunkfilm_sucher_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],function(){return r(9954)});a=r.O(a)})();
//# sourceMappingURL=app.09861d7d.js.map